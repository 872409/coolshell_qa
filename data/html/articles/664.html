<!DOCTYPE html><!--[if IE 8]>
<html id="ie8" dir="ltr" lang="zh-CN"
	prefix="og: https://ogp.me/ns#" >
<![endif]--><!--[if !(IE 8) ]><!--><html dir="ltr" lang="zh-CN" prefix="og: https://ogp.me/ns#"><!--<![endif]--><head><meta charset="UTF-8"/><title>使用PHP的cURL库 | 酷 壳 - CoolShell</title><link rel="stylesheet" type="text/css" href="/assets/all.min.css"/><link rel="shortcut icon" href="/assets/favicon.png"/></head>
<body class="post-template-default single single-post postid-664 single-format-standard group-blog">

<div id="page" class="hfeed site">

<div class="container">
<div class="row">

</div>
</div>
<div id="content" class="site-content">
<div class="container">
<div class="row">
<div id="primary" class="content-area  col-md-12" style="margin-top: 40px;">
<main id="main" role="main">
<article id="post-664" class="post-content post-664 post type-post status-publish format-standard hentry category-phpdev category-proglanguage tag-curl tag-php">
<header class="entry-header">
<span class="screen-reader-text">使用PHP的cURL库</span>
<h1 class="entry-title">使用PHP的cURL库</h1>
<div class="entry-meta">
<h5 class="entry-date"><i class="fa fa-calendar-o"></i> <a href="/articles/664.html" title="17:12" rel="bookmark"><time class="entry-date" datetime="2009-04-25T17:12:32+08:00" pubdate="">2009年04月25日 </time></a><span class="byline"><span class="sep"></span><i class="fa fa-user"></i>
<span class="author vcard"><a class="url fn n" href="/haoel" title="View all posts by 陈皓" rel="author">陈皓</a></span></span> <i class="fa fa-comments-o"></i><span class="screen-reader-text">评论 </span> <a href="/articles/664.html#comments" class="comments-link">12 条评论</a> <i class="fa fa-users" style="margin-left:10px;"></i> 21,301 人阅读</h5>
</div>
</header>
<div class="entry-content">
<p><a href="https://coolshell.cn/wp-content/uploads/2009/04/phpinfo_curl.png"></a>使用PHP的cURL库可以简单和有效地去抓网页。你只需要运行一个脚本，然后分析一下你所抓取的网页，然后就可以以程序的方式得到你想要的数据了。无论是你想从从一个链接上取部分数据，或是取一个XML文件并把其导入数据库，那怕就是简单的获取网页内容，cURL 是一个功能强大的PHP库。本文主要讲述如果使用这个PHP库。</p>
<p><strong> 启用 cURL 设置</strong><br/>
首先，我们得先要确定我们的PHP是否开启了这个库，你可以通过使用php_info()函数来得到这一信息。</p>
<pre data-enlighter-language="php" class="EnlighterJSRAW">&lt;?php
    phpinfo();
?&gt;</pre>
<p><span id="more-664"></span></p>
<p> </p>
<p>如果你可以在网页上看到下面的输出，那么表示cURL库已被开启。</p>
<p><a href="https://coolshell.cn/wp-content/uploads/2009/04/phpinfo_curl.png"><img decoding="async" title="phpinfo_curl" src="/uploads/2009/04/phpinfo_curl.png" alt="phpinfo_curl" width="498" height="91" srcset=""/></a></p>
<p>如果你看到的话，那么你需要设置你的PHP并开启这个库。如果你是在Windows平台下，那么非常简单，你需要改一改你的php.ini文件的设置，找到php_curl.dll，并取消前面的分号注释就行了。如下所示：</p>
<pre data-enlighter-language="c" class="EnlighterJSRAW">

//取消下在的注释
extension=php_curl.dll 
</pre>
<p>如果你是在Linux下面，那么，你需要重新编译你的PHP了，编辑时，你需要打开编译参数——在configure命令上加上“–with-curl” 参数。</p>
<p><strong>一个小示例</strong><br/>
如果一切就绪，下面是一个小例程：</p>
<pre data-enlighter-language="php" class="EnlighterJSRAW">&lt;?php
// 初始化一个 cURL 对象
$curl = curl_init(); 

// 设置你需要抓取的URL
curl_setopt($curl, CURLOPT_URL, &#39;https://coolshell.cn&#39;);

// 设置header
curl_setopt($curl, CURLOPT_HEADER, 1);

// 设置cURL 参数，要求结果保存到字符串中还是输出到屏幕上。
curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);

// 运行cURL，请求网页
$data = curl_exec($curl);

// 关闭URL请求
curl_close($curl);

// 显示获得的数据
var_dump($data);
</pre>
<p> </p>
<p><strong>如何POST数据</strong></p>
<p>上面是抓取网页的代码，下面则是向某个网页POST数据。假设我们有一个处理表单的网址<a href="http://www.example.com/sendSMS.php">http://www.example.com/sendSMS.php</a>，其可以接受两个表单域，一个是电话号码，一个是短信内容。</p>
<pre data-enlighter-language="php" class="EnlighterJSRAW" data-enlighter-highlight="9,10">&lt;?php
    $phoneNumber = &#39;13912345678&#39;;
    $message = &#39;This message was generated by curl and php&#39;;
    $curlPost = &#39;pNUMBER=&#39;  . urlencode($phoneNumber) . &#39;&amp;MESSAGE=&#39; . urlencode($message) . &#39;&amp;SUBMIT=Send&#39;;
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, &#39;http://www.example.com/sendSMS.php&#39;);
    curl_setopt($ch, CURLOPT_HEADER, 1);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_POST, 1);
    curl_setopt($ch, CURLOPT_POSTFIELDS, $curlPost);
    $data = curl_exec();
    curl_close($ch);
?&gt;
</pre>
<p> 从上面的程序我们可以看到，使用CURLOPT_POST设置HTTP协议的POST方法，而不是GET方法，然后以CURLOPT_POSTFIELDS设置POST的数据。</p>
<p><strong>关于代理服务器</strong></p>
<pre>下面是一个如何使用代理服务器的示例。请注意其中高亮的代码，代码很简单，我就不用多说了。</pre>
<pre data-enlighter-language="php" class="EnlighterJSRAW" data-enlighter-highlight="6,7,8">&lt;?php 
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, &#39;http://www.example.com&#39;);
    curl_setopt($ch, CURLOPT_HEADER, 1);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_HTTPPROXYTUNNEL, 1);
    curl_setopt($ch, CURLOPT_PROXY, &#39;fakeproxy.com:1080&#39;);
    curl_setopt($ch, CURLOPT_PROXYUSERPWD, &#39;user:password&#39;);
    $data = curl_exec();
    curl_close($ch);
?&gt;

</pre>
<p> <strong>关于SSL和Cookie</strong></p>
<p>关于SSL也就是HTTPS协议，你只需要把CURLOPT_URL连接中的http://变成https://就可以了。当然，还有一个参数叫CURLOPT_SSL_VERIFYHOST可以设置为验证站点。</p>
<p>关于Cookie，你需要了解下面三个参数：</p>
<ul>
<li>CURLOPT_COOKIE，在当面的会话中设置一个cookie</li>
<li>CURLOPT_COOKIEJAR，当会话结束的时候保存一个Cookie</li>
<li>CURLOPT_COOKIEFILE，Cookie的文件。</li>
</ul>
<p><strong>HTTP服务器认证</strong></p>
<p>最后，我们来看一看HTTP服务器认证的情况。</p>
<pre data-enlighter-language="php" class="EnlighterJSRAW" data-enlighter-highlight="5,6">&lt;?php 
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, &#39;http://www.example.com&#39;);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_HTTPAUTH, CURLAUTH_BASIC);
    curl_setopt(CURLOPT_USERPWD, &#39;[username]:[password]&#39;)

    $data = curl_exec();
    curl_close($ch);
?&gt;
</pre>
<p>关于其它更多的内容，请大家参看相关的cURL手册吧。</p>
<div style="margin-top: 15px; font-size: 16px;color: #cc0000;">
<p align="center"><strong>（转载本站文章请注明作者和出处 <a href="/">酷 壳 – CoolShell</a> ，请勿用于任何商业用途）</strong></p>
</div>

<div id="post-ratings-664-loading" class="post-ratings-loading"><img src="https://coolshell.cn/wp-content/plugins/wp-postratings/images/loading.gif" width="16" height="16" class="post-ratings-image"/>Loading...</div>
</div>
<footer class="entry-footer">
<hr/><div class="row"><div class="col-md-6 cattegories"><span class="cat-links"><i class="fa fa-folder-open"></i>
<a href="javascript:void(0)" rel="category tag">PHP脚本</a>, <a href="javascript:void(0)" rel="category tag">编程语言</a></span></div><div class="col-md-6 tags"><span class="tags-links"><i class="fa fa-tags"></i> <a href="javascript:void(0)" rel="tag">cURL</a>, <a href="javascript:void(0)" rel="tag">PHP</a></span></div></div> </footer>
</article>

<div class="fixed"></div> 
</main>

<div class="post-comments">
<div id="comments" class="comments-area">
<h2 class="comments-title">
《<span>使用PHP的cURL库</span>》的相关评论 </h2>
<ol class="comment-list">
<li id="comment-79489" class="pingback even thread-even depth-1">
<div class="comment-body">
Pingback： <a href="http://shieffan.me/2011-09/use-php-curl/" class="url" rel="ugc external nofollow">使用PHP的cURL库 – 清水稀饭</a> </div>
</li>
<li id="comment-1287308" class="comment odd alt thread-odd thread-alt depth-1">
<article id="div-comment-1287308" class="comment-body">
<footer class="comment-meta">
<div class="comment-author vcard">
<img alt="" src="https://secure.gravatar.com/avatar/3e756233e3dbeee1b82547e51616b6d6?s=50&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3e756233e3dbeee1b82547e51616b6d6?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"/> <b class="fn"><a href="http://www.elesos.com" class="url" rel="ugc external nofollow">艺搜天下站长</a></b><span class="says">说道：</span> </div>
<div class="comment-metadata">
<a href="/articles/664.html#comment-1287308"><time datetime="2014-02-18T13:45:53+08:00">2014年02月18日 13:45</time></a> </div>
</footer>
<div class="comment-content">
<p>这个不错，</p>
</div>
 </article>
</li>
<li id="comment-1563303" class="comment even thread-even depth-1">
<article id="div-comment-1563303" class="comment-body">
<footer class="comment-meta">
<div class="comment-author vcard">
<img alt="" src="https://secure.gravatar.com/avatar/e7e2df175160c31997e039145455f8fe?s=50&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e7e2df175160c31997e039145455f8fe?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"/> <b class="fn">iCH1990</b><span class="says">说道：</span> </div>
<div class="comment-metadata">
<a href="/articles/664.html#comment-1563303"><time datetime="2014-10-05T22:48:04+08:00">2014年10月05日 22:48</time></a> </div>
</footer>
<div class="comment-content">
<p>刚好要用，学习了~</p>
</div>
 </article>
</li>
<li id="comment-1613508" class="comment odd alt thread-odd thread-alt depth-1">
<article id="div-comment-1613508" class="comment-body">
<footer class="comment-meta">
<div class="comment-author vcard">
<img alt="" src="https://secure.gravatar.com/avatar/de7f6241ed85f8e51098106767eaf078?s=50&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/de7f6241ed85f8e51098106767eaf078?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"/> <b class="fn">lance</b><span class="says">说道：</span> </div>
<div class="comment-metadata">
<a href="/articles/664.html#comment-1613508"><time datetime="2014-11-25T14:19:52+08:00">2014年11月25日 14:19</time></a> </div>
</footer>
<div class="comment-content">
<p>这个挺有用的</p>
</div>
 </article>
</li>
<li id="comment-1803004" class="comment even thread-even depth-1">
<article id="div-comment-1803004" class="comment-body">
<footer class="comment-meta">
<div class="comment-author vcard">
<img alt="" src="https://secure.gravatar.com/avatar/1f7c90e750fea8d06e6766f9cf6d7981?s=50&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1f7c90e750fea8d06e6766f9cf6d7981?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"/> <b class="fn">woke</b><span class="says">说道：</span> </div>
<div class="comment-metadata">
<a href="/articles/664.html#comment-1803004"><time datetime="2015-12-30T14:12:53+08:00">2015年12月30日 14:12</time></a> </div>
</footer>
<div class="comment-content">
<p>总结的漂亮！</p>
</div>
 </article>
</li>
<li id="comment-1811231" class="comment odd alt thread-odd thread-alt depth-1">
<article id="div-comment-1811231" class="comment-body">
<footer class="comment-meta">
<div class="comment-author vcard">
<img alt="" src="https://secure.gravatar.com/avatar/400afc0827442a2826240ded94cf6d18?s=50&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/400afc0827442a2826240ded94cf6d18?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"/> <b class="fn"><a href="http://www.awaimai.com" class="url" rel="ugc external nofollow">歪麦博客</a></b><span class="says">说道：</span> </div>
<div class="comment-metadata">
<a href="/articles/664.html#comment-1811231"><time datetime="2016-03-04T21:00:32+08:00">2016年03月04日 21:00</time></a> </div>
</footer>
<div class="comment-content">
<p>很有价值，学习了！！</p>
</div>
 </article>
</li>
<li id="comment-1811366" class="pingback even thread-even depth-1">
<div class="comment-body">
Pingback： <a href="http://www.awaimai.com/610.html" class="url" rel="ugc external nofollow">PHP cURL库函数抓取页面内容 - 歪麦博客</a> </div>
</li>
<li id="comment-1913207" class="pingback odd alt thread-odd thread-alt depth-1">
<div class="comment-body">
Pingback： <a href="http://ltq.im/php-curl.html" class="url" rel="ugc external nofollow">PHP cURL库函数抓取页面内容-最长的路</a> </div>
</li>
<li id="comment-1913467" class="pingback even thread-even depth-1">
<div class="comment-body">
Pingback： <a href="http://it.xmulib.org/2016/03/11/1839/" class="url" rel="ugc external nofollow">64位Win7系统配置PHP Curl扩展 – <span class="__cf_email__" data-cfemail="743d20340c1901181d16">[email protected]</span></a> </div>
</li>
<li id="comment-1926013" class="pingback odd alt thread-odd thread-alt depth-1">
<div class="comment-body">
Pingback： <a href="http://wordpress.c.ac.cn/php%e6%9d%82%e8%b0%88/42.html" class="url" rel="ugc external nofollow">PHP中curl讲解 - duantian</a> </div>
</li>
<li id="comment-1926983" class="pingback even thread-even depth-1">
<div class="comment-body">
Pingback： <a href="http://david-chan.top/index.php/2016/03/03/php-curl%e5%ba%93%e5%87%bd%e6%95%b0%e6%8a%93%e5%8f%96%e9%a1%b5%e9%9d%a2%e5%86%85%e5%ae%b9/" class="url" rel="ugc external nofollow">PHP cURL库函数抓取页面内容 – David chan</a> </div>
</li>
<li id="comment-1928525" class="pingback odd alt thread-odd thread-alt depth-1">
<div class="comment-body">
Pingback： <a href="http://www.joolm.com/?p=21" class="url" rel="ugc external nofollow">PHP cURL库函数抓取页面内容 - 高级PHP编程</a> </div>
</li>
</ol>

</div>
</div>
</div>

</div> 
</div>

</div>

</div>




















</body></html>